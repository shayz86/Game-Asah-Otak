<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Kekacauan Warna</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: 'Fredoka', sans-serif;
  touch-action: manipulation;
}

/* ===== FIX KUNCI (ANTI OVERLAY BUG) ===== */
.hidden {
  display: none !important;
  pointer-events: none !important;
}

.screen {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.screen.active {
  pointer-events: auto;
}

button {
  pointer-events: auto !important;
}

#buttons-container {
  position: relative;
  z-index: 20;
}

/* Animasi */
.shake { animation: shake 0.5s; }
@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  50% { transform: translateX(5px); }
  75% { transform: translateX(-5px); }
  100% { transform: translateX(0); }
}
</style>
</head>

<body id="main-body" class="bg-gradient-to-br from-gray-900 to-black text-white flex items-center justify-center">

<!-- START -->
<div id="start-screen" class="screen active flex flex-col items-center justify-center text-center p-6 bg-black/50 backdrop-blur">
  <h1 class="text-4xl font-bold mb-4">KEKACAUAN WARNA</h1>
  <button onclick="startGame()" class="px-8 py-3 bg-blue-600 rounded-full font-bold text-lg">
    MULAI GAME
  </button>
</div>

<!-- GAME -->
<div id="game-ui" class="screen hidden flex flex-col w-full max-w-md h-full p-4">
  <div class="flex justify-between items-center mb-4">
    <div>Skor: <span id="score">0</span></div>
    <div class="w-1/2 h-3 bg-gray-700 rounded overflow-hidden">
      <div id="timer" class="h-full bg-green-500"></div>
    </div>
  </div>

  <div class="flex-1 flex flex-col items-center justify-center">
    <div id="instruction" class="mb-4 text-sm opacity-80">Pilih WARNA</div>
    <div id="word" class="text-5xl font-bold mb-8">MERAH</div>
    <div id="buttons-container" class="grid grid-cols-2 gap-3 w-full"></div>
  </div>
</div>

<!-- GAME OVER -->
<div id="game-over" class="screen hidden flex flex-col items-center justify-center bg-black/80 text-center">
  <h2 class="text-3xl text-red-400 mb-2">Game Over</h2>
  <p class="mb-4">Skor: <span id="final-score">0</span></p>
  <button onclick="startGame()" class="px-6 py-2 bg-white text-black rounded-full font-bold">
    Main Lagi
  </button>
</div>

<script>
/* ===== DATA ===== */
const COLORS = {
  merah: '#ef4444',
  biru: '#3b82f6',
  hijau: '#22c55e',
  kuning: '#eab308'
};

let score = 0;
let timerInterval;
let time = 3000;
let correctKey = '';

const screens = {
  start: document.getElementById('start-screen'),
  game: document.getElementById('game-ui'),
  over: document.getElementById('game-over')
};

const elScore = document.getElementById('score');
const elWord = document.getElementById('word');
const elButtons = document.getElementById('buttons-container');
const elTimer = document.getElementById('timer');
const elFinalScore = document.getElementById('final-score');

/* ===== SCREEN MANAGER (FIX UTAMA) ===== */
function showScreen(name) {
  Object.values(screens).forEach(s => {
    s.classList.add('hidden');
    s.classList.remove('active');
  });
  screens[name].classList.remove('hidden');
  screens[name].classList.add('active');
}

/* ===== GAME LOGIC ===== */
function startGame() {
  score = 0;
  time = 3000;
  elScore.textContent = score;
  showScreen('game');
  nextRound();
}

function nextRound() {
  clearInterval(timerInterval);
  elButtons.innerHTML = '';

  const keys = Object.keys(COLORS);
  correctKey = keys[Math.floor(Math.random() * keys.length)];
  elWord.textContent = correctKey.toUpperCase();
  elWord.style.color = COLORS[correctKey];

  keys.forEach(key => {
    const btn = document.createElement('button');
    btn.textContent = key.toUpperCase();
    btn.className = 'h-16 rounded-xl bg-black/40 font-bold';
    btn.onclick = () => checkAnswer(key, btn);
    elButtons.appendChild(btn);
  });

  startTimer();
}

function startTimer() {
  let start = Date.now();
  timerInterval = setInterval(() => {
    let progress = 1 - (Date.now() - start) / time;
    elTimer.style.width = Math.max(0, progress * 100) + '%';
    if (progress <= 0) endGame();
  }, 16);
}

function checkAnswer(key, btn) {
  if (key === correctKey) {
    score += 10;
    elScore.textContent = score;
    time = Math.max(1200, time - 100);
    nextRound();
  } else {
    btn.classList.add('shake');
    setTimeout(endGame, 300);
  }
}

function endGame() {
  clearInterval(timerInterval);
  elFinalScore.textContent = score;
  showScreen('over');
}
</script>

</body>
</html>
